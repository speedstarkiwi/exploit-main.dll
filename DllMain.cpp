BOOL __stdcall DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)//average dll
{
  HMODULE v3; 
  FARPROC RtlSetUnhandledExceptionFilter;
  HANDLE v5;

  if ( fdwReason )
  {
    if ( fdwReason == 1 )//true
    {
      DisableThreadLibraryCalls(hinstDLL);//axon
      v3 = GetModuleHandleA("ntdll.dll");
      RtlSetUnhandledExceptionFilter = GetProcAddress(v3, "RtlSetUnhandledExceptionFilter");
      ((void (__stdcall *)(void (__cdecl __noreturn *)(int, int)))RtlSetUnhandledExceptionFilter)(sub_100422F0);
      v5 = CreateThread(0, 0, sub_10056100, 0, 0, 0);
      CloseHandle(v5);
      return 1;
    }
  }
  else//false
  {
    sub_1005C050();
  }
  return 1;
}
